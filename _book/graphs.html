<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.290">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R for Research in Action - 24&nbsp; Graphs</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./graph_ggplot.html" rel="next">
<link href="./program_profiling.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./graphs.html">Part 4: Graphics</a></li><li class="breadcrumb-item"><a href="./graphs.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Graphs</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R for Research in Action</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Introduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">R Objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data Types</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_packages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Packages</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro_style.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Code Style</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Part 1: Manipulating Data</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_reading.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Reading Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_writing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Writing Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_tidydata.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Tidy Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_transforming.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Transforming Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_subsetting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Subsetting R Objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_plyrdplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Plyr &amp; Dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_date.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Date Manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_text.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Text Manipulation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./manipu_databases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">R and Data Bases</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Part 2: Statistics in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_descriptive.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Descriptive Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_exploratory.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Exploratory Analysis Pipeline</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_inferential.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Inferential Statistics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./stats_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Regression Analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Part 3: Programming in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./program_habits.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Programming Habits</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./program_logic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Logic</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./program_functions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Functions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./program_iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Iteration</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./program_debugging.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Debugging</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./program_profiling.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Profiling R Code</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Part 4: Graphics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graphs.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Graphs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graph_ggplot.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Creating a ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./graph_types.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Types of Graphs</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Part 5: Modeling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_flow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Modeling Workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_spend.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Spending Your Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_fit.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Fitting Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model_random.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Random Numbers</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Part 6: Time Series</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">TS Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_objects.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">TS Objects</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">TS Components</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_decomposition.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Decomposition of TS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_seasonality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Seasonality Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_correlation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Correlation Analysis</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_forecast_workflow.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Forecasting Workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_forecast_regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Forecasting with Linear Regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_forecast_ma.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Forecasting with Moving Average Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_forecast_smooth.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Forecasting with Exponential Smoothing</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_forecast_arima.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Forecasting with ARIMA Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./time_forecast_ml.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Forecasting with Machine Learning Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true">
 <span class="menu-text">Part 7: Data Products</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./products.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Building Data Products</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./product_repro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Reproducible Reporting</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#principles-of-graphics" id="toc-principles-of-graphics" class="nav-link active" data-scroll-target="#principles-of-graphics"><span class="header-section-number">24.1</span> Principles of Graphics</a></li>
  <li><a href="#types-of-graphs" id="toc-types-of-graphs" class="nav-link" data-scroll-target="#types-of-graphs"><span class="header-section-number">24.2</span> Types of Graphs</a>
  <ul class="collapse">
  <li><a href="#one-dimension-graphs" id="toc-one-dimension-graphs" class="nav-link" data-scroll-target="#one-dimension-graphs"><span class="header-section-number">24.2.1</span> One-dimension graphs</a></li>
  <li><a href="#multi-dimension-graphs" id="toc-multi-dimension-graphs" class="nav-link" data-scroll-target="#multi-dimension-graphs"><span class="header-section-number">24.2.2</span> Multi-dimension graphs</a></li>
  </ul></li>
  <li><a href="#the-base-plotting-system" id="toc-the-base-plotting-system" class="nav-link" data-scroll-target="#the-base-plotting-system"><span class="header-section-number">24.3</span> The Base Plotting System</a>
  <ul class="collapse">
  <li><a href="#how-to-create-a-base-plot" id="toc-how-to-create-a-base-plot" class="nav-link" data-scroll-target="#how-to-create-a-base-plot"><span class="header-section-number">24.3.1</span> How to Create a Base Plot?</a></li>
  <li><a href="#graphics-devices" id="toc-graphics-devices" class="nav-link" data-scroll-target="#graphics-devices"><span class="header-section-number">24.3.2</span> Graphics Devices</a></li>
  <li><a href="#graphics-parameters" id="toc-graphics-parameters" class="nav-link" data-scroll-target="#graphics-parameters"><span class="header-section-number">24.3.3</span> Graphics Parameters</a></li>
  <li><a href="#make-a-plot-with-plotxy" id="toc-make-a-plot-with-plotxy" class="nav-link" data-scroll-target="#make-a-plot-with-plotxy"><span class="header-section-number">24.3.4</span> Make a Plot with <code>plot(x,y)</code></a></li>
  <li><a href="#augmenting-a-plot" id="toc-augmenting-a-plot" class="nav-link" data-scroll-target="#augmenting-a-plot"><span class="header-section-number">24.3.5</span> Augmenting a Plot</a></li>
  <li><a href="#color-in-plots" id="toc-color-in-plots" class="nav-link" data-scroll-target="#color-in-plots"><span class="header-section-number">24.3.6</span> Color in Plots</a></li>
  <li><a href="#copying-plots" id="toc-copying-plots" class="nav-link" data-scroll-target="#copying-plots"><span class="header-section-number">24.3.7</span> Copying Plots</a></li>
  <li><a href="#complementary-packages" id="toc-complementary-packages" class="nav-link" data-scroll-target="#complementary-packages"><span class="header-section-number">24.3.8</span> Complementary Packages</a></li>
  </ul></li>
  <li><a href="#the-lattice-system" id="toc-the-lattice-system" class="nav-link" data-scroll-target="#the-lattice-system"><span class="header-section-number">24.4</span> The Lattice System</a>
  <ul class="collapse">
  <li><a href="#when-to-use-trellis-plots" id="toc-when-to-use-trellis-plots" class="nav-link" data-scroll-target="#when-to-use-trellis-plots"><span class="header-section-number">24.4.1</span> When to Use Trellis Plots</a></li>
  <li><a href="#how-to-use-lattice" id="toc-how-to-use-lattice" class="nav-link" data-scroll-target="#how-to-use-lattice"><span class="header-section-number">24.4.2</span> How to Use Lattice</a></li>
  </ul></li>
  <li><a href="#d-plots" id="toc-d-plots" class="nav-link" data-scroll-target="#d-plots"><span class="header-section-number">24.5</span> 3D Plots</a></li>
  <li><a href="#ggplot2" id="toc-ggplot2" class="nav-link" data-scroll-target="#ggplot2"><span class="header-section-number">24.6</span> ggplot2</a>
  <ul class="collapse">
  <li><a href="#installation" id="toc-installation" class="nav-link" data-scroll-target="#installation"><span class="header-section-number">24.6.1</span> Installation</a></li>
  <li><a href="#geometric-objects" id="toc-geometric-objects" class="nav-link" data-scroll-target="#geometric-objects"><span class="header-section-number">24.6.2</span> Geometric objects</a></li>
  <li><a href="#plotly" id="toc-plotly" class="nav-link" data-scroll-target="#plotly"><span class="header-section-number">24.6.3</span> Plotly</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Graphs</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="principles-of-graphics" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="principles-of-graphics"><span class="header-section-number">24.1</span> Principles of Graphics</h2>
<p><strong>1. Show comparisons</strong></p>
<p>You should always be comparing at least two things.</p>
<p><strong>2. Show causality, mechanism, explanation, systematic structure</strong></p>
<p>Generally, it’s difficult to prove that one thing causes another thing even with the most carefully collected data. But it’s still often useful for your data graphics to indicate what you are thinking about in terms of cause.</p>
<p><strong>3. Show multivariate data</strong></p>
<p>The point is that data graphics should attempt to show this information as much as possible, rather than reduce things down to one or two features that we can plot on a page… From the plot it seems that there is a slight negative relationship between the two variables….This example illustrates just one of many reasons why it can be useful to plot multivariate data and to show as many features as intelligently possible. In some cases, you may uncover unexpected relationships depending on how they are plotted or visualized.</p>
<p><strong>4. Integrate evidence</strong></p>
<p>Data graphics should make use of many modes of data presentation simultaneously, not just the ones that are familiar to you or that the software can handle. One should never let the tools available drive the analysis; one should integrate as much evidence as possible on to a graphic as possible.</p>
<p><strong>5. Describe and document the evidence</strong></p>
<p>Data graphics should be appropriately documented with labels, scales, and sources. A general rule for me is that a data graphic should tell a complete story all by itself. Is there enough information on that graphic for the person to get the story? While it is certainly possible to be too detailed, I tend to err on the side of more information rather than less.</p>
<p><strong>6. Content, Content, Content</strong></p>
<p>Analytical presentations ultimately stand or fall depending on the quality, relevance, and integrity of their content. This includes the question being asked and the evidence presented in favor of certain hypotheses. Starting with a good question, developing a sound approach, and only presenting information that is necessary for answering that question, is essential to every data graphic.</p>
</section>
<section id="types-of-graphs" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="types-of-graphs"><span class="header-section-number">24.2</span> Types of Graphs</h2>
<p>Visualizing the data via graphics can be important at the beginning stages of data analysis to understand basic properties of the data, to find simple patterns in data, and to suggest possible modeling strategies. In later stages of an analysis, graphics can be used to “debug” an analysis, if an unexpected (but not necessarily wrong) result occurs, or ultimately, to communicate your findings to others.</p>
<p>We will make a <strong>distinction between exploratory graphs and final graphs</strong>:</p>
<p><strong>Exploratory graphs</strong> are usually made very quickly and a lot of them are made in the process of checking out the data, developing a personal understanding of the data and to prioritize tasks for follow up. Details like axis orientation or legends, while present, are generally cleaned up and prettified if the graph is going to be used for communication later.</p>
<section id="one-dimension-graphs" class="level3" data-number="24.2.1">
<h3 data-number="24.2.1" class="anchored" data-anchor-id="one-dimension-graphs"><span class="header-section-number">24.2.1</span> One-dimension graphs</h3>
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 30%">
<col style="width: 58%">
</colgroup>
<thead>
<tr class="header">
<th>Graph</th>
<th>Code</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Five-number summary</td>
<td><code>fivenum()</code>, <code>summary()</code></td>
<td></td>
</tr>
<tr class="even">
<td>Boxplots</td>
<td><code>boxplot(pollution$pm25, col = "blue")</code></td>
<td>Commonly plot outliers that go beyond the bulk of the data</td>
</tr>
<tr class="odd">
<td>Barplot</td>
<td><code>table(pollution$region) %&gt;% barplot(col = "wheat")</code></td>
<td>For visualizing categorical data, with the number of entries for each category being proportional to the height of the bar</td>
</tr>
<tr class="even">
<td>Histogram</td>
<td><p><code>hist(pollution$pm25, col = "green", breaks = 100)</code></p>
<p><code>rug(pollution$pm25)</code></p>
<p><code>abline(v = 12, lwd = 2)</code></p>
<p><code>abline(v = median(pollution$pm25), col = "magenta", lwd = 4)</code></p></td>
<td>Check skewness of the data, symmetry, multi-modality, and other features</td>
</tr>
<tr class="odd">
<td>Density plot</td>
<td><p><code>a &lt;- density(airquality$Ozone, na.rm = TRUE)</code></p>
<p><code>plot(a)</code></p></td>
<td>Computes a non-parametric estimate of the distribution of a variables</td>
</tr>
</tbody>
</table>
</section>
<section id="multi-dimension-graphs" class="level3" data-number="24.2.2">
<h3 data-number="24.2.2" class="anchored" data-anchor-id="multi-dimension-graphs"><span class="header-section-number">24.2.2</span> Multi-dimension graphs</h3>
<table class="table">
<colgroup>
<col style="width: 7%">
<col style="width: 40%">
<col style="width: 52%">
</colgroup>
<thead>
<tr class="header">
<th>Graph</th>
<th>Code</th>
<th>Use</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Multiple 1-D plots</td>
<td><p><code>boxplot(pm25 ~ region, data = pollution, col = "red")</code></p>
<p><code>par(mfrow = c(2, 1), mar = c(4, 4, 2, 1))</code></p>
<p><code>hist(subset(pollution, region == "east")$pm25, col = "green")</code></p>
<p><code>with(subset(airquality, Month == 5), points(Wind, Ozone, col = "blue"))</code></p>
<p><code>hist(subset(pollution, region == "west")$pm25, col = "green")&gt; boxplot(pm25 ~ region, data = pollution, col = "red")</code></p>
<p><code>par(mfrow = c(2, 1), mar = c(4, 4, 2, 1))</code></p>
<p><code>hist(subset(pollution, region == "east")$pm25, col = "green")</code></p>
<p><code>with(subset(airquality, Month == 5), points(Wind, Ozone, col = "blue"))</code></p>
<p><code>hist(subset(pollution, region == "west")$pm25, col = "green")</code></p></td>
<td>For seeing the relationship between two variables, especially when one is naturally <strong>categorical</strong></td>
</tr>
<tr class="even">
<td>Scatterplots</td>
<td><p><code>with(pollution, plot(latitude, pm25, col = region)) &gt; abline(h = 12, lwd = 2, lty = 2)</code></p>
<p><code>levels(pollution$region)</code></p>
<p><code>par(mfrow = c(2, 1), mar = c(4, 4, 2, 1))</code></p>
<p><code>hist(subset(pollution, region == "east")$pm25, col = "green")</code></p>
<p><code>hist(subset(pollution, region == "west")$pm25, col = "green")</code></p></td>
<td>Visualizing two continuous variables</td>
</tr>
<tr class="odd">
<td>Scatter plot matrix</td>
<td><code>pairs(~var1+var2+var3+var4+var5, data=data, main="scatterplot matrix")</code></td>
<td>It is used to find the correlation between a variable and other variables, and to select the important variables, which is also known as variable selection</td>
</tr>
<tr class="even">
<td>Smooth scatterplots</td>
<td><code>with(airquality, {plot(Temp, Ozone), lines(loess.smooth(Temp, Ozone))</code></td>
<td>Similar to scatterplots but rather plots a 2-D histogram. Can be useful for scatterplots with many many data points</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="the-base-plotting-system" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="the-base-plotting-system"><span class="header-section-number">24.3</span> The Base Plotting System</h2>
<p>The <strong>base plotting system</strong> is the original plotting system for R. The basic model is sometimes referred to as the “artist’s palette” model. The idea is you start with blank canvas and build up from there.</p>
<p>You will typically start with a plot function (or similar plot creating function) to initiate a plot and then annotate the plot. If you don’t have a completely well-formed idea of how you want your data to look, you’ll often start by “throwing some data on the page” and then slowly add more information to it as our thought process evolves.</p>
<p>There are a few <strong>downsides</strong> though:</p>
<ul>
<li>You can’t go backwards once the plot has started.</li>
<li>While the base plotting system is nice in that it gives you the flexibility to specify these kinds of details to painstaking accuracy, sometimes it would be nice if the system could just figure it out for you.</li>
<li>It’s difficult to describe or translate a plot to others because there’s no clear graphical language or grammar that can be used to communicate what you’ve done.</li>
</ul>
<section id="how-to-create-a-base-plot" class="level3" data-number="24.3.1">
<h3 data-number="24.3.1" class="anchored" data-anchor-id="how-to-create-a-base-plot"><span class="header-section-number">24.3.1</span> How to Create a Base Plot?</h3>
<ol type="1">
<li><p>First, you must read the data into R with <code>read.csv()</code>. For example, the <em>avgpm25.csv</em> dataset contains the annual mean PM2.5 averaged over the period 2008 through 2010</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>class <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"numeric"</span>, <span class="st">"character"</span>, <span class="st">"factor"</span>, <span class="st">"numeric"</span>, <span class="st">"numeric"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>pollution <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/avgpm25.csv"</span>, <span class="at">colClasses =</span> class)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Explicitly launch a graphics device.</p></li>
<li><p>Call a plotting function to make a plot (Note: if you are using a file device, no plot will appear on the screen).</p></li>
<li><p>Annotate the plot if necessary.</p></li>
<li><p>Explicitly close graphics device with dev.off() (this is very important!).</p></li>
</ol>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Open PDF device; create 'myplot.pdf' in my working directory</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pdf</span>(<span class="at">file =</span> <span class="st">"myplot.pdf"</span>, <span class="at">width =</span> <span class="dv">4</span>, <span class="at">height =</span> <span class="dv">3</span>) <span class="co"># The height and width arguments are in units of inches.</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create plot and send to a file (no plot appears on screen) </span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(faithful, <span class="fu">plot</span>(eruptions, waiting))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Annotate plot; still nothing on screen </span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="at">main =</span> <span class="st">"Old Faithful Geyser data"</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Close the PDF file device </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Now you can view the file 'myplot.pdf' on your computer</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Let’s further detail each of the steps involved in creating a <strong>base plot</strong>.</p>
</section>
<section id="graphics-devices" class="level3" data-number="24.3.2">
<h3 data-number="24.3.2" class="anchored" data-anchor-id="graphics-devices"><span class="header-section-number">24.3.2</span> Graphics Devices</h3>
<p>We can think of a <strong>graphics device</strong> as being a platform upon which the plot is created. If we create a plot, then a default graphics device is automatically opened for the plot to appear upon. In other words, when you make a plot in R, it has to be “sent” to a specific <strong>graphics device</strong>.</p>
<p>The most common place for a plot to be “sent” is the <strong>screen</strong> device. Functions like <code>plot()</code> in base, <code>xyplot()</code> in lattice, or <code>qplot</code> in ggplot2 will default to sending a plot to the screen device. Therefore, when making a plot, you need to consider how the plot will be used to determine what device the plot should be sent to.</p>
<p>The <strong>list of devices</strong> supported by your installation of R is found in <code>?Devices</code>.</p>
<ul>
<li>Using the commands <code>pdf</code>, <code>postscript</code>, <code>jpeg</code>, <code>png</code>, or <code>bmp</code>, we can also produce graphics in the formats that correspond to these names.</li>
<li>The <code>jpeg</code>, <code>png</code>, and <code>bmp</code> graphics are all <strong>raster-style</strong> graphics, which may translate poorly when included in a document.</li>
<li>In contrast, the <code>pdf</code>, <code>postscript</code>, and <code>windows metafile</code> (win.metafile, available on Windows) formats allow for <strong>vector-style</strong> graphics, which are scaleable, and better suited to integration in documents.</li>
</ul>
<table class="table">
<colgroup>
<col style="width: 50%">
<col style="width: 50%">
</colgroup>
<thead>
<tr class="header">
<th>Vector</th>
<th>Bitmap</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Good for line drawings and plots with solid colors using a modest number of points</td>
<td>good for plots with a large number of points, natural scenes or web-based plots</td>
</tr>
<tr class="even">
<td>pdf (line-type graphics, resizes well, usually portable)</td>
<td>png (good for line drawings or images with solid colors)</td>
</tr>
<tr class="odd">
<td>svg (XML-based scalable vector graphics; supports animation and interactivity)</td>
<td>jpeg (good for plotting many many many points, does not resize well)</td>
</tr>
<tr class="even">
<td>win.metafile</td>
<td>tiff</td>
</tr>
<tr class="odd">
<td>postscript</td>
<td>bmp</td>
</tr>
</tbody>
</table>
<p>It is possible to <strong>open multiple graphics devices</strong> (screen, file, or both), for example when viewing multiple plots at once. Plotting can only occur on one graphics device at a time, though.</p>
<p>One way of having more than one plot visible is to open additional graphics devices. In a Windows environment this is done by using the command <code>windows()</code> before each additional plot.</p>
<p>To create a graphics device without a plot, we call the function that is specific to our operating system (that is, <code>windows</code> for Windows, <code>quartz</code> for Mac, and <code>X11</code> for Unix).</p>
<p>The <strong>currently active graphics device</strong> can be found by calling <code>dev.cur()</code></p>
<p>Every open graphics device is assigned an integer starting with 2 (there is no graphics device 1). You can change the active graphics device with <code>dev.set(&lt;integer&gt;)</code>.</p>
</section>
<section id="graphics-parameters" class="level3" data-number="24.3.3">
<h3 data-number="24.3.3" class="anchored" data-anchor-id="graphics-parameters"><span class="header-section-number">24.3.3</span> Graphics Parameters</h3>
<p><strong>Graphics parameters</strong> control how output appears on graphics devices. To get a complete list with their current values, type <code>par()</code>. Some of the parameters mentioned above, namely <code>pch</code>, <code>lwd</code> and <code>col</code>, are examples of graphics parameters. To get the value of a specific parameter, for example <code>pch</code>, type <code>par("pch")</code>.</p>
<p>Some <strong>graphics parameters</strong> can apply to <strong>one or more plots</strong>, and others only make sense when applied to graphics devices. For example, to change the symbol for a single plot, we could include the argument <code>pch = 2</code> in the call to the plot function. However, we could also make this change for all graphics that are produced on the device.</p>
<p>To change a graphics parameter for the graphics device, we use the <code>par</code> command. These are some examples:</p>
<ul>
<li><p><code>par(mfrow = c(a,b))</code> where a and b are integers, will create a matrix of plots on one page, with a rows and b columns. These will be filled by rows; use mfcol if you wish to fill them by columns.</p>
<p><em>Example:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>), <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span><span class="fu">sin</span>(x), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">100</span>, <span class="at">n =</span> <span class="dv">1001</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span><span class="fu">sin</span>(x), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">1001</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span><span class="fu">sin</span>(x), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">n =</span> <span class="dv">1001</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(x<span class="sc">*</span><span class="fu">sin</span>(x), <span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="fl">0.1</span>, <span class="at">n =</span> <span class="dv">1001</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="graphs_files/figure-html/unnamed-chunk-1-1.png" class="quarto-discovered-preview-image img-fluid" width="672"></p>
</div>
</div></li>
<li><p><code>par(mar = c(bottom, left, top, right))</code> will create space around each plot, in which to write axis labels and titles. Measurements are in units of character widths.</p></li>
<li><p><code>par(oma = c(bottom, left, top, right))</code> will create space around the matrix of plots (an outer margin). Measurements are in units of character widths.</p></li>
<li><p><code>par(las = 1)</code> rotates labels on the y-axis to be horizontal rather than vertical.</p></li>
<li><p><code>par(pty = "s")</code> forces the plot shape to be square. The alternative is that the plot shape is mutable, which is the default, and corresponds to <code>pty ="m"</code>.</p></li>
</ul>
</section>
<section id="make-a-plot-with-plotxy" class="level3" data-number="24.3.4">
<h3 data-number="24.3.4" class="anchored" data-anchor-id="make-a-plot-with-plotxy"><span class="header-section-number">24.3.4</span> Make a Plot with <code>plot(x,y)</code></h3>
<p><code>plot(x, y)</code> is used to plot one vector against another, with the <code>x</code> values on the x-axis and the <code>y</code> values on the y-axis.</p>
<p>The <code>plot</code> command offers a wide variety of <strong>options for customizing</strong> the graphic. Each of the following arguments can be used within the plot statement, singly or together, separated by commas</p>
<ul>
<li><p><code>type = "p"</code>: Determines the type of plot, with options:</p>
<ul>
<li>“p” for points (the default);</li>
<li>“l” for lines;</li>
<li>“b” for both, with gaps in the lines for the points; …</li>
</ul>
<p><em>Example:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">with</span>(airquality, <span class="fu">plot</span>(Wind, Ozone, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">"Ozone and Wind in New York City"</span>,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"p"</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="graphs_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p><code>points(x, y)</code>: To add points (<code>x[1]</code>, <code>y[1]</code>), (<code>x[2]</code>, <code>y[2]</code>), … to the current plot.</p></li>
<li><p><code>lines(x, y)</code>: To add lines.</p></li>
<li><p><code>abline(v = xpos)</code> and <code>abline(h = ypos)</code>: to draw vertical or horizontal lines. - <code>col</code>: Both points and lines take the optional input from <code>col</code> (e.g.&nbsp;“red”, “blue”, etc.). The complete list of available colours can be obtained by the <code>colours</code> function (or <code>colors</code>).</p>
<p><em>Example:</em> # Plot with a Regression Line</p>
<ul>
<li>First make the plot (as above).</li>
<li>Fit a simple linear regression model using the <code>lm()</code> function.</li>
<li>Take the output of <code>lm()</code> and pass it to the <code>abline()</code> function which automatically takes the information from the model object and calculates the corresponding regression line</li>
</ul></li>
<li><p><code>text(x, y, labels)</code>: To add the text labels [i] at the point (<code>x[i]</code>, <code>y[i]</code>). The optional input <code>pos</code> is used to indicate where to position the labels in relation to the points.</p></li>
<li><p><code>title(text)</code>: To add a title, where <code>text</code> is a character string.</p></li>
<li><p><code>main = "Plot title goes in here"</code>: provides the plot title.</p></li>
<li><p><code>xlab = " "</code> / <code>ylab = " "</code>: To add axis labels.</p>
<p>Note: In a call to plot, the arguments for <code>main</code>, <code>sub</code>, and <code>xlab</code> and <code>ylab</code> can be character strings or expressions that contain a mathematical expression. For <strong>mathematical typesetting</strong> you can use the functions <code>expression</code>(require graphics) and <code>bquote</code>(base):</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>xlab <span class="ot">=</span> <span class="fu">expression</span>(alpha),</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>ylab <span class="ot">=</span> <span class="fu">expression</span>(<span class="dv">100</span> <span class="sc">%*%</span> (alpha<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> alpha<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">15</span>),</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Mix of mathematical expressions and character strings into a single expression by using the paste function</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>main <span class="ot">=</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Function: "</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">f</span>(alpha) <span class="sc">==</span> <span class="dv">100</span> <span class="sc">%*%</span> (alpha<span class="sc">^</span><span class="dv">3</span> <span class="sc">-</span> alpha<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="dv">15</span>)),</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>xlab = expression(alpha)</code> tells R to interpret alpha in the context of the MML (mathematical markup language), producing an α as the label for the x-axis.</p></li>
<li><p><code>pch = k</code>: Determines the shape of points, with k taking a value from 1 to 25.</p></li>
<li><p><code>lwd = 1</code>: line width, default 1.</p></li>
<li><p><code>xlim = c(a,b)</code>/ `<code>ylim = c(a,b)</code>: Will set the lower and upper limits of the x-axis/y-axis to be a and b, respectively.</p></li>
</ul>
<p>As an <strong>example</strong> we plot part of the parabola y<sup>2</sup> = 4x, as well as its focus and directrix. We make use of the surprisingly useful input <code>type = "n"</code>, which results in the graph dimensions being established, and the axes being drawn, but nothing else.</p>
<p><em>Example:</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y.upper <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(x)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>y.lower <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">2</span><span class="sc">*</span><span class="fu">sqrt</span>(x)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>y.max <span class="ot">&lt;-</span> <span class="fu">max</span>(y.upper)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>y.min <span class="ot">&lt;-</span> <span class="fu">min</span>(y.lower)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>), <span class="fu">c</span>(y.min, y.max), <span class="at">type =</span> <span class="st">"n"</span>, <span class="at">xlab =</span> <span class="st">"x"</span>, <span class="at">ylab =</span> <span class="st">"y"</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y.upper)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, y.lower)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(<span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="st">"focus (1, 0)"</span>, <span class="at">pos=</span><span class="dv">4</span>)</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="dv">1</span>, y.min, <span class="st">"directrix x = -1"</span>, <span class="at">pos =</span> <span class="dv">4</span>)</span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"The parabola y^2 = 4*x"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="graphs_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="augmenting-a-plot" class="level3" data-number="24.3.5">
<h3 data-number="24.3.5" class="anchored" data-anchor-id="augmenting-a-plot"><span class="header-section-number">24.3.5</span> Augmenting a Plot</h3>
<p>A traditional plot can be augmented using any of a number of different tools after its creation. A number of these different steps are detailed below:</p>
<ol type="1">
<li><p>Start by creating the <strong>plot object</strong>, which sets up the dimensions of the space, but omit any plot objects for the moment:</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>opar1 <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">las =</span> <span class="dv">1</span>, <span class="at">mar=</span><span class="fu">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>))   </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ufc<span class="sc">$</span>dbh.cm, ufc<span class="sc">$</span>height.m, <span class="at">axes=</span><span class="cn">FALSE</span>, </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">""</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab=</span><span class="st">""</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">type=</span><span class="st">"n"</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Next, we <strong>add the points</strong>. Here we use different colours and symbols for different heights of trees: those that are realistic, and those that are not, which may reflect measurement errors. We use the vectorised <code>ifelse()</code> function:</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(ufc<span class="sc">$</span>dbh.cm, ufc<span class="sc">$</span>height.m,     </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">ifelse</span>(ufc<span class="sc">$</span>height.m <span class="sc">&gt;</span> <span class="fl">4.9</span>, <span class="st">"darkseagreen4"</span>, <span class="st">"red"</span>),</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">pch =</span> <span class="fu">ifelse</span>(ufc<span class="sc">$</span>height.m <span class="sc">&gt;</span> <span class="fl">4.9</span>, <span class="dv">1</span>, <span class="dv">3</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Then we <strong>add axes</strong>. The following are the simplest possible calls. We can also control the locations of the tickmarks, and their labels; we can overlay different axes, change colour, and so on. <code>?axis</code> provides the details:</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>We can next <strong>add axis labels</strong> using margin text (switching back to vertical direction for the y-axis text):</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>opar2 <span class="ot">&lt;-</span> <span class="fu">par</span>(<span class="at">las=</span><span class="dv">0</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Diameter (cm)"</span>, <span class="at">side=</span><span class="dv">1</span>, <span class="at">line=</span><span class="dv">3</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">"Height (m)"</span>, <span class="at">side=</span><span class="dv">2</span>, <span class="at">line=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p><strong>Wrap the plot</strong> in the traditional frame. As before, we can opt to use different line types and different colours:</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">box</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Finally, we <strong>add a legend</strong>:</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="at">x =</span> <span class="dv">60</span>, <span class="at">y =</span> <span class="dv">15</span>, <span class="fu">c</span>(<span class="st">"Normal trees"</span>, <span class="st">"A weird tree"</span>),</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col=</span><span class="fu">c</span>(<span class="st">"darkseagreen3"</span>, <span class="st">"red"</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">pch=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span>),</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">bty=</span><span class="st">"n"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note the first two arguments: the location of the legend can also be expressed relative to the graph components, for example, by “bottomright”.</p></li>
<li><p>If we wish, we can return the graphics environment to a previous state:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(opar1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
</ol>
<p>Check out the <strong>playwith package</strong>, which provides interaction with graphical objects at a level unattainable in base R.</p>
</section>
<section id="color-in-plots" class="level3" data-number="24.3.6">
<h3 data-number="24.3.6" class="anchored" data-anchor-id="color-in-plots"><span class="header-section-number">24.3.6</span> Color in Plots</h3>
<p>Typically we add color to a plot, not to improve its artistic value, but to add another dimension to the visualization. It makes sense that the range and palette of colors you use will depend on the kind of data you are plotting. Careful choices of plotting color can have an impact on how people interpret your data and draw conclusions from them.</p>
<p>The function <code>colors()</code> lists the names of (657) colors you can use in any plotting function. Typically, you would specify the color in a (base) plotting function via the <strong>col</strong> argument.</p>
<p>The <strong>grDevices package</strong> has two functions, they differ only in the type of object that they return:</p>
<ul>
<li><p><strong>colorRamp</strong>: Take a palette of colors and return a function that takes values between 0 and 1.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorRamp</span>(<span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>)) </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pal</span>(<span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The numbers in the matrix will range from 0 to 255 and indicate the quantities of red, green, and blue (RGB) in columns 1, 2, and 3 respectively. there are over 16 million colors that can be expressed in this way.</p>
<p>The idea here is that you do not have to provide just two colors in your initial color palette; you can start with multiple colors and <code>colorRamp()</code> will interpolate between all of them.</p></li>
<li><p><strong>colorRampPalette</strong>: Takes a palette of colors and returns a function that takes integer arguments and returns a vector of colors interpolating the palette (like <code>heat.colors()</code> or <code>topo.colors()</code>).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"yellow"</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pal</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Returns 3 colors in between red and yellow. Note that the colors are represented as hexadecimal strings.</p></li>
<li><p>Note that the <code>rgb()</code> function can be used to produce any color via red, green, blue proportions and return a hexadecimal representation:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">234</span>, <span class="at">maxColorValue =</span> <span class="dv">255</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>Part of the art of creating good color schemes in data graphics is to start with an appropriate color palette that you can then interpolate with a function like <code>colorRamp()</code> or <code>colorRampPalette()</code>.</p></li>
</ul>
<p>For improved color palettes you can use the <strong>RColorBrewer package</strong>. Here is a display of all the color palettes available from this package:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer) </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">display.brewer.all</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="graphs_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p>The <code>brewer.pal()</code> function creates nice looking color palettes especially for thematic maps:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>(cols <span class="ot">&lt;-</span> <span class="fu">brewer.pal</span>(<span class="dv">3</span>, <span class="st">"BuGn"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#E5F5F9" "#99D8C9" "#2CA25F"</code></pre>
</div>
</div>
<p>These three colors make up your initial palette. Then you can pass them to <code>colorRampPalette()</code> to create my interpolating function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> <span class="fu">colorRampPalette</span>(cols)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now you can plot your data using this newly created color (ramp) palette:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">image</span>(volcano, <span class="at">col =</span> <span class="fu">pal</span>(<span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><p>The <code>smoothScatter()</code> function is very useful for making <strong>scatterplots</strong> of very large datasets:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10000</span>) </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">smoothScatter</span>(x, y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="graphs_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
<li><p><strong>Adding transparency</strong>: Color transparency can be added via the alpha parameter to <code>rgb()</code> to produce color specifications with varying levels of transparency.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "#FF00001A"</code></pre>
</div>
</div>
<p><strong>Transparency</strong> can be useful when you have plots with a high density of points or lines. If you add some transparency to the black circles, you can get a better sense of the varying density of the points in the plot.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># x, y from the previous example</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> <span class="fu">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.15</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="graphs_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ul>
</section>
<section id="copying-plots" class="level3" data-number="24.3.7">
<h3 data-number="24.3.7" class="anchored" data-anchor-id="copying-plots"><span class="header-section-number">24.3.7</span> Copying Plots</h3>
<p>Note that copying a plot is not an exact operation, so the result may not be identical to the original:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Copy my plot to a PNG file  (follows the previous code from pdf creation)</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.copy</span>(png, <span class="at">file =</span> <span class="st">"geyserplot.png"</span>) </span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Don't forget to close the PNG device! </span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="complementary-packages" class="level3" data-number="24.3.8">
<h3 data-number="24.3.8" class="anchored" data-anchor-id="complementary-packages"><span class="header-section-number">24.3.8</span> Complementary Packages</h3>
<ul>
<li><p><strong>graphics</strong>: contains plotting functions for the “base” graphing systems, including <code>plot</code>, <code>hist</code>, <code>boxplot</code> and many others</p></li>
<li><p><strong>grdevices</strong>: contains all the code implementing the various graphics devices, including X11, PDF, PostScript, PNG, etc.</p></li>
</ul>
</section>
</section>
<section id="the-lattice-system" class="level2" data-number="24.4">
<h2 data-number="24.4" class="anchored" data-anchor-id="the-lattice-system"><span class="header-section-number">24.4</span> The Lattice System</h2>
<p>Trellis graphics are a data visualisation framework developed at the Bell Labs, which have been implemented in R as the <strong>lattice package</strong>.</p>
<p><strong>Trellis graphics</strong> are a set of techniques for displaying multidimensional data. They allow great flexibility for producing <strong>conditioning plots</strong>; that is, plots obtained by conditioning on the value of one of the variables.</p>
<p>To use Trellis graphics you must first you must load the <strong>lattice package</strong> with the library function: <code>library(lattice)</code>.</p>
<section id="when-to-use-trellis-plots" class="level3" data-number="24.4.1">
<h3 data-number="24.4.1" class="anchored" data-anchor-id="when-to-use-trellis-plots"><span class="header-section-number">24.4.1</span> When to Use Trellis Plots</h3>
<ul>
<li><strong>Lattice plots</strong> tend to be most useful for <strong>conditioning types of plots</strong>, i.e.&nbsp;looking at how y changes with x across levels of z. These types of plots are useful for looking at <strong>multidimensional data</strong> and often allow you to squeeze a lot of information into a single window or page.</li>
<li>With the lattice system, plots are created with a single function call, such as <code>xyplot()</code> or <code>bwplot()</code>.</li>
<li>Note that there is no real distinction between the functions that create or initiate plots and the functions that annotate plots because <strong>it all happens at once</strong>.</li>
<li>Another difference from base plotting is that things like <strong>margins and spacing</strong> are set automatically. This is possible because entire plot is specified at once via a single function call.</li>
<li>The notion of <strong>panels</strong> comes up a lot with lattice plots because you typically have many panels in a lattice plot (each panel typically represents a condition, like “region”).</li>
<li>Once a plot is created, you <strong>cannot “add”</strong> to the plot (but of course you can just make it again with modifications).</li>
</ul>
</section>
<section id="how-to-use-lattice" class="level3" data-number="24.4.2">
<h3 data-number="24.4.2" class="anchored" data-anchor-id="how-to-use-lattice"><span class="header-section-number">24.4.2</span> How to Use Lattice</h3>
<p>To illustrate the use of the <strong>lattice package</strong> we use the <em>ufc dataset</em>, where <em>dbh (diameter at breast height)</em> and <em>height</em> vary by <em>species</em>. That is, the plots are conditioned on the value of the variable species.</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># These plots display a distribution of values taken on by the variable dbh, divided up according to the value of the variable species</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">densityplot</span>(<span class="sc">~</span> dbh.cm <span class="sc">|</span> species, <span class="at">data =</span> ufc) <span class="co"># A density plot</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(<span class="sc">~</span> dbh.cm <span class="sc">|</span> species, <span class="at">data =</span> ufc) <span class="co"># # A box and whiskers plot</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(<span class="sc">~</span> dbh.cm <span class="sc">|</span> species, <span class="at">data =</span> ufc) <span class="co"># A histogram</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co"># We plot height as a function of dbh.</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(height.m <span class="sc">~</span> dbh.cm <span class="sc">|</span> species, <span class="at">data =</span> ufc) <span class="co"># A scatterplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>All four commands require a formula object, which is described using <code>~</code>and <code>|</code>.</p>
<ul>
<li>If a <strong>dataframe</strong> is passed to the function, using the argument <code>data</code>, then the column names of the dataframe can be used for describing the model.</li>
<li>We interpret <code>y ~ x | a</code> as saying we want <code>y</code> as a function of <code>x</code>, divided up by the different levels of <code>a</code>.</li>
<li>If `<code>a</code> is not a factor then a factor will be created by coercion.</li>
<li>If we are just interested in <code>x</code> we still include the <code>~</code> symbol, so that R knows that we are specifying a model.</li>
<li>If we wish to provide within-panel conditioning on a second variable, then we use the group argument.</li>
</ul>
<p>In order to display <strong>numerous lattice objects</strong> on a graphics device, we call the <code>print</code> function with the <code>split</code> and more arguments.</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Place a lattice object (called my.lat) in the top-right corner of a 3-row, 2-column graphics device, and allow for more objects</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(my.lat, <span class="at">split =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="at">more =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>See <code>?print.trellis</code> for further details.</p>
<p>Graphics produced by lattice are <strong>highly customisable</strong>.</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">xyplot</span>(height.m <span class="sc">~</span> dbh.cm <span class="sc">|</span> species,</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ufc,</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">subset =</span> species <span class="sc">%in%</span> <span class="fu">list</span>(<span class="st">"WC"</span>, <span class="st">"GF"</span>),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">panel =</span> <span class="cf">function</span>(x, y, ...) {</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">panel.xyplot</span>(x, y, ...),       </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">panel.abline</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x), ...)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>    },</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"Diameter (cm)"</span>,</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">"Height (m)"</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that the <code>subset</code> argument is a logical expression or a vector of integers, and is used to restrict the data that are plotted. We can also change the order of the panels using the <code>index.cond</code> argument (see <code>?xyplot</code> for more details). The panels are plotted bottom left to top right by default, or top left to bottom right if the argument <code>as.table = TRUE</code> is supplied.</p>
<p>The <code>panel</code> argument accepts a function, the purpose of which is to control the appearance of the plot in each panel. The panel function should have one input argument for each variable in the model, not including the conditioning variable.</p>
</section>
</section>
<section id="d-plots" class="level2" data-number="24.5">
<h2 data-number="24.5" class="anchored" data-anchor-id="d-plots"><span class="header-section-number">24.5</span> 3D Plots</h2>
<p>R provides considerable functionality for constructing <strong>3D graphics</strong>, using either the <strong>base</strong> graphics engine or the <strong>lattice package</strong>. However, its is recommended to use the <strong>lattice package</strong>, because the data can be supplied to the lattice functions in a familiar structure: observations in rows and variables in columns, unlike that required by the base 3D graphics engine (observations in a grid).</p>
<p><em>Example:</em></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>ufc.plots <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"../data/ufc-plots.csv"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(ufc.plots)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">wireframe</span>(vol.m3.ha <span class="sc">~</span> east <span class="sc">*</span> north,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">expression</span>(<span class="fu">paste</span>(<span class="st">"Volume ("</span>, m<span class="sc">^</span><span class="dv">3</span>, ha<span class="sc">^</span>{<span class="sc">-</span><span class="dv">1</span>}, <span class="st">")"</span>, <span class="at">sep =</span>        <span class="st">""</span>)),</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">"East (m)"</span>, <span class="at">ylab =</span> <span class="st">"North (m)"</span>,</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> ufc.plots</span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>To learn more about <strong>base-graphics 3D plots</strong>, run the demonstrations <code>demo(persp)</code> and <code>demo(image)</code> and look at the examples presented.</p>
</section>
<section id="ggplot2" class="level2" data-number="24.6">
<h2 data-number="24.6" class="anchored" data-anchor-id="ggplot2"><span class="header-section-number">24.6</span> ggplot2</h2>
<p><strong>ggplot2</strong> is one of the most elegant and most versatile systems for making graphs. <strong>ggplot2</strong> implements the grammar of graphics, a coherent system for describing and building graphs.</p>
<p><strong>ggplot2</strong> splits the difference between base and lattice in a number of ways. Taking cues from lattice, the ggplot2 system automatically deals with spacings, text, titles but also allows you to annotate by “adding” to a plot.</p>
<p>You can find more information in the Graphs section <a href="./ggplot.html">here</a>.</p>
<section id="installation" class="level3" data-number="24.6.1">
<h3 data-number="24.6.1" class="anchored" data-anchor-id="installation"><span class="header-section-number">24.6.1</span> Installation</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>A typical plot with the ggplot package looks as follows:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(mpg)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qplot</span>(displ, hwy, <span class="at">data =</span> mpg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In <strong>ggplot2</strong>, aesthetics are the things we can see (e.g.&nbsp;position, color, fill, shape, line type, size). You can use aesthetics in ggplot2 via the <code>aes()</code> function:</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>var1, <span class="at">y=</span>var2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="geometric-objects" class="level3" data-number="24.6.2">
<h3 data-number="24.6.2" class="anchored" data-anchor-id="geometric-objects"><span class="header-section-number">24.6.2</span> Geometric objects</h3>
<p><strong>Geometric objects</strong> are the plots or graphs you want to put in the chart.</p>
<p>You can use <code>geom_point()</code> to create a scatterplot, <code>geom_line()</code> to create a line plot, and <code>geom_boxplot()</code> to create a boxplot in the chart.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">help.search</span>(<span class="st">"geom_"</span>, <span class="at">package=</span><span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In ggplot2, <code>geom</code> is also the layers of the chart. You can add in one geom object after another, just like adding one layer after another layer.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>var1, <span class="at">y=</span>var2)) <span class="sc">+</span> </span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="st">"red"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="plotly" class="level3" data-number="24.6.3">
<h3 data-number="24.6.3" class="anchored" data-anchor-id="plotly"><span class="header-section-number">24.6.3</span> Plotly</h3>
<p><strong>Plotly JS</strong> allows you to create interactive, publication-quality charts. You can create a Plotly chart using <strong>ggplot</strong>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"plotly"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>var1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>var2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="at">mean=</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(var1, var2)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>gg <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data) <span class="sc">+</span> <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x=</span>var1, <span class="at">y=</span>var2))</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">ggplotly</span>(gg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./program_profiling.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Profiling R Code</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./graph_ggplot.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Creating a ggplot</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>